<meta charset="UTF-8">
        <meta name="viewport1" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/luxon@2.0.1/build/global/luxon.min.js"></script>
        <style>

           #tit {
               clear: left;
                font-family: Arial, Helvetica, sans-serif;
                font-size: 20px;
                text-align: center;
                           }
            #sub1 {
                font-family: Arial, Helvetica, sans-serif;
                font-size: 18px;
                text-align: center;
            }
            #sub2 {
                clear: left;
                font-family: Arial, Helvetica, sans-serif;
                font-size: 18px;
                text-align: center;
                line-height: 60px;
            }
            #dpk1 {
                margin: 10px;
                font-family: Arial, Helvetica, sans-serif;
            }
            #dpk2 {
                margin: 10px;
                font-family: Arial, Helvetica, sans-serif;
            }
            
            .btn {
                font-size: 18px;
                font-family: Arial, Helvetica, sans-serif;
                padding: 10px 16px;
                margin: 5px;
                border-radius: 4px;
                background-color: #e7e7e7;
            }
            .lab {
                font-family: Arial, Helvetica, sans-serif;
                font-style: normal;
                white-space: nowrap;
            }

            /* Style the active class, and buttons on mouse-over */
            .active, .btn:hover {
            background-color: #1a73e8;
            color: white;
            }
            #ts {
                white-space: nowrap;
            }
            .box {
                width: 230px;
                height: 230px;
                margin: 20px;
                padding: 5px 10px;
                font-family: Arial, Helvetica, sans-serif;
                font-size: 17px;
                color: white;
                float: left;
            }
            .inner {
                height: 230px; 
                margin-top: -30px;
                text-align:center;
                display:flex;                
                align-items: center;
                justify-content: center;
                font-size: 80px;
                font-weight: bold;
                color: white;               
            }
            .cwra {
                width: 540px;
                height: 270px;
                margin: 20px;
                float: left;
            }
            .cle {
                clear: left;
            }
           #con {
                max-width: 1280px;
                margin: auto;
           }
           #wra1 {
               /* local */
               /* max-width: 1160px; */
               /* Wordpress */
               max-width: 1080px;
               margin: auto;
            }
            #btw {
                max-width: 1160px;
                margin: auto;
                text-align:center;
            }
            #dtw {
                max-width: 1160px;
                margin: auto;
                text-align:center;
            }
            #wra2 {
               /* local */
               /* max-width: 1160px; */
               /* Wordpress */
               max-width: 1080px;
               margin: auto;
            }
            #wra3 {
               max-width: 1160px;
               margin: auto;
            }
           #tem {
               background-color: #ff6d56;
            }
           #hum {
               background-color: #57b7dd;
            }
           #lig {
               background-color: #ffbe0a;
            }
           #mot {
               background-color: #8ac539;
            }
            #up {
               background-color: #409AE6;
            }
           #do {
               background-color: #52B4E6;
            }
           #he {
               background-color: #88D1E6;
            }
           #fl {
               background-color: #418CDA;
            }



            @media only screen and (max-width: 1190px) {
                #wra1 {
                max-width: 580px;                
                }
                #wra2 {
                max-width: 580px;                
                }
                #wra3 {
                max-width: 580px;                
                }
            }
            @media only screen and (max-width: 610px) {
                #wra1 {
                max-width: 290px;
                 }
                 #btw {
                max-width: 300px;
                 }
                 #dtw {
                width: 260px;
                 }                 
                 #wra2 {
                max-width: 290px;
                 }
                 #wra3 {
                max-width: 350px;
                 }
                 .cwra {
                     width: 350px;
                     height: 300px;
                     margin: auto;
                 }
                 
            }
        
       </style>        
        
         <script>

        // Start an IIFE to use `await` at the top level
        (async function(){
        var global_data1 = await getData1();
        var global_data2 = await getData2();

        
                const container = document.createElement('div')
                const title1 = document.createElement('h1')
                const title2 = document.createElement('h1')
                const subtitle1 = document.createElement('div')
                const subtitle2 = document.createElement('div')

                const nowtemp = document.createElement('div')
                const nowhumid = document.createElement('div')
                const nowlight = document.createElement('div')
                const nowmotion = document.createElement('div')

                const now_upst = document.createElement('div')
                const now_down = document.createElement('div')
                const now_head = document.createElement('div')
                const now_flow = document.createElement('div')

                const inner_nowtemp = document.createElement('div')
                const inner_nowhumid = document.createElement('div')
                const inner_nowlight = document.createElement('div')
                const inner_nowmotion = document.createElement('div')
                
                const inner_now_upst = document.createElement('div')
                const inner_now_down = document.createElement('div')
                const inner_now_head = document.createElement('div')
                const inner_now_flow = document.createElement('div')
                
                const wrap11 = document.createElement('div')
                const wrap12 = document.createElement('div')
                const wrap13 = document.createElement('div')
                const clear = document.createElement('p')

                
                container.id = "con"
                title1.id = "tit"
                title2.id = "tit"
                subtitle1.id = "sub1"
                subtitle2.id = "sub2"

                nowtemp.id = "tem"
                nowhumid.id = "hum"
                nowlight.id = "lig"
                nowmotion.id = "mot"

                now_upst.id = "up"
                now_down.id = "do"
                now_head.id = "he"
                now_flow.id = "fl"

                wrap11.id = "wra1"
                wrap12.id = "wra2"
                wrap13.id = "wra3"

                nowtemp.className = "box"
                nowhumid.className = "box"
                nowlight.className = "box"
                nowmotion.className = "box"

                now_upst.className = "box"
                now_down.className = "box"
                now_head.className = "box"
                now_flow.className = "box"

                inner_nowtemp.className = "inner"
                inner_nowhumid.className = "inner"
                inner_nowlight.className = "inner"
                inner_nowmotion.className = "inner"

                inner_now_upst.className = "inner"
                inner_now_down.className = "inner"
                inner_now_head.className = "inner"
                inner_now_flow.className = "inner"


                clear.className = "cle"

                title1.innerHTML = '<a href="/turbine-house-data/">Turbine House</a>'
                //Filter out other devices
                var selection1 = global_data1.filter(function(item){
                        return item.device_id == 'rdghydro-ers001'
                    })
                subtitle1.innerHTML = `Current conditions: <span id="ts">${luxon.DateTime.fromISO(selection1[0].received_at).toFormat('ff')} </span>`

                nowtemp.innerHTML = "Temperature (&deg;C)"
                nowhumid.innerHTML = "Humidity (&percnt;)"
                nowlight.innerHTML = "Light (Lux)" 
                nowmotion.innerHTML = "Motion counts"
                inner_nowtemp.textContent = selection1[0].temperature
                inner_nowhumid.textContent = selection1[0].humidity
                inner_nowlight.textContent = selection1[0].light
                inner_nowmotion.textContent = selection1[0].motion 

                nowtemp.append(inner_nowtemp)
                nowhumid.append(inner_nowhumid)
                nowlight.append(inner_nowlight)
                nowmotion.append(inner_nowmotion)

                wrap11.append(nowtemp, nowhumid, nowlight, nowmotion, clear)
                container.append(title1)
                container.append(subtitle1)
                container.append(wrap11, clear)

                title2.innerHTML = '<a href="/water-level-data/">Water levels and flow</a>'
                subtitle2.innerHTML = `Current conditions: <span id="ts">${luxon.DateTime.fromISO(global_data2[0].received_at).toFormat('ff')} </span>`

                now_upst.innerHTML = "Upstream (metres AOD)"
                now_down.innerHTML = "Downstream (metres AOD)"
                now_head.innerHTML = "Head (metres)" 
                now_flow.innerHTML = "Flow (cubic metres/sec)"
                inner_now_upst.textContent = global_data2[0].upstream.toFixed(2)
                inner_now_down.textContent = global_data2[0].downstream.toFixed(2)
                inner_now_head.textContent = (global_data2[0].upstream - global_data2[0].downstream).toFixed(2)
                inner_now_flow.textContent = ((global_data2[0].gen1_flow_ls + global_data2[0].gen2_flow_ls) / 1000).toFixed(2)

                now_upst.append(inner_now_upst)
                now_down.append(inner_now_down)
                now_head.append(inner_now_head)
                now_flow.append(inner_now_flow)

                wrap12.append(now_upst, now_down, now_head, now_flow, clear)
                container.append(title2)
                container.append(subtitle2)
                container.append(wrap12, clear)
                
                //local
                //document.body.append(container)
                //Wordpress
                var target = document.getElementsByClassName("entry-content");
                target[0].append(container)

            

        //closing of IIFE function
        })();


// functions
        async function getData1() {
            const response = await fetch('https://thingitude-apps.com:9445/api/ttn/all') 
            const data = await response.json() 
            return data           
        }
 
        async function getData2() {
            //local
            //const response = await fetch('/powergen') 
            //Wordpress
            const response = await fetch('https://thingitude-apps.com:9445/api/plc/all') 
            const data = await response.json() 
            return data           
        }
        
        </script>
